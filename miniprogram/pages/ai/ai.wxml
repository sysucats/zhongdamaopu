<!--pages/ai/ai.wxml-->
<page-meta>
  <navigation-bar title="æ‹ç…§è¯†çŒ«" background-color="white" front-color="black" />
</page-meta>

<!-- å‹ç¼©å›¾ç‰‡ç”¨ -->
<canvas type="2d" style="width: 2000px; height: 2000px; border: 3rpx solid red; left: 100000px; position: fixed;" class="canvas" canvas-id="canvasForCompres"></canvas>

<!-- æ— æ‘„åƒå¤´æƒé™ -->
<view wx:if="{{!cameraAuth}}" class="authTips">
<text class="text">æä¾›ç›¸æœºæƒé™å æ‹ç…§è¯†åˆ«çŒ«å’ªğŸˆ\n æˆ– ä¸Šä¼ çŒ«å’ªç…§ç‰‡è¿›è¡Œè¯†åˆ«\n  </text>
<button class="authBtn" bindtap="reqCamAuth">å¯ç”¨ç›¸æœºæƒé™</button>  
</view>

<!-- ç›¸æœº & ç…§ç‰‡é¢„è§ˆ -->
<camera wx:if="{{cameraAuth && !src}}" device-position="{{lensDirection}}" resolution="high" frame-size="large" flash="off" binderror="error"
  class="camera"></camera>
<image mode="widthFix" wx:if="{{src}}" src="{{src}}" class="camera"></image>

<!-- å¿«é—¨ç­‰åŠŸèƒ½æ  -->
<view wx:if="{{!src}}" class="control">
  <image wx:if="{{!src}}" class='btn' bindtap='choosePhoto' src='../../images/ai/choose.png'></image>
  <button hover-class="hoverShutter" class="shutter" type="primary" bindtap="takePhoto"></button>
  <image class='btn' bindtap='reverseCamera' src='../../images/ai/reverse.png'></image>
</view>
<view wx:if="{{src}}" class="control_after">
  <image class='btn_after' bindtap='back' src='../../images/ai/back.png'></image>
  <image class='btn_after' bindtap='savePhoto' src='../../images/ai/save.png'></image>
</view>

<!-- è¯†åˆ«ç»“æœ -->
<view class="result">
  <view wx:if="{{catList}}" class="title">è¯†åˆ«ç»“æœ</view>
  <view wx:for="{{catList}}" class="item" hover-class="hoverItem" data-cat_id="{{item._id}}" bindtap="clickCatCard">
    <image class="photo" mode="aspectFill" src="{{item.photo.photo_compressed}}"></image>
    <view class="info">
      <view class="name">{{item.name}}</view>
      <view class='detail'> 
        <image wx:if="{{item.campus}}" mode='aspectFit' class='icon' src='../../images/card/card/pos.png'></image>
        <view class="detailText">{{item.campus +' '+ item.area}}</view>

        <image wx:if="{{item.characteristics_string}}" mode='aspectFit' class='icon' src='../../images/card/card/cat.png'></image>
        <view class="detailText">{{item.characteristics_string}}</view>
      </view>
    </view>

    <view class="accuracy">{{item.accuracy + '%'}}</view>

    <image class='enter' src='../../images/ai/enter.png'></image>
  </view>
</view>
